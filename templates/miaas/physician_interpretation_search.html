{% if not user_session or user_session.user_type != 'physician' %}
<script type="text/javascript">
location.replace({{ "'" }}{% url 'miaas:index' %}{{ "'" }});
</script>
{% endif %}

{% load staticfiles %}
{% load my_filters %}

{% include 'miaas/template_header.html' %}

<!-- custom css -->


{% include 'miaas/template_nav_physician.html' %}

<div class="container">
    <section class="section section-default">
        <div class="row">
            <div class="col-xs-12 col-title">
                <h2 class="text-primary">Search Medical Image Interpretation Request</h2>
            </div>
            <div class="col-xs-12 col-table">
                <div class="table-container row">
                    <div class="table-title col-xs-12 col-md-4">Medical Image List</div>
                    <form class="table-search col-xs-12 col-md-8 form-group form-inline" accept-charset="UTF-8" method="get">
                        <button class="btn btn-default pull-right" type="submit">Search</button>
                        <input name="request_subject" id="inputSearch" type="text" class="form-control pull-right" placeholder="Search">
                        <select name="image_type" id="selectImageType" class="form-control pull-right" style="display: none;">
                            <option value="EEG">EEG (Electroencephalography)</option>
                            <option value="ECG">ECG (Electrocardiography)</option>
                            <option value="EMG">EMG (Electromyography)</option>
                            <option value="CT">CT (Computed Tomography)</option>
                            <option value="X-ray">X-ray (Radiography)</option>
                            <option value="MRI">MRI (Magnetic Resonance Imaging)</option>
                            <option value="US">Ultrasonography (Ultrasound)</option>
                        </select>
                        <select name="query_type" id="selectSearch" class="form-control pull-right">
                            <option>Request Subject</option>
                            <option>Image Type</option>
                        </select>
                    </form>
                    {% if requested_intpr.requested_intpr_list %}
                    <table class="table table-striped table-hover col-xs-12">
                        <thead>
                            <td>Request Date</td>
                            <td>Patient</td>
                            <td>Image Type</td>
                            <td>Request Subject</td>
                            <td>Image Subject</td>
                            <td>Level</td>

                        </thead>
                        <tbody>
                        {% for request_info in requested_intpr.requested_intpr_list %}
                            <tr onclick="javascript: $.LoadingOverlay('show'); location.href='{% url 'miaas:interpretation_search_detail' request_info.request_id %}';">
                                <td>{{ request_info.requested_date|datetime_string }}</td>
                                <td>{{ request_info.patient_id }}</td>
                                <td>{{ request_info.image_type }}</td>
                                <td>{{ request_info.request_subject }}</td>
                                <td>{{ request_info.image_subject }}</td>
                                <td>{{ request_info.level }}</td>

                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    {% endif %}
                    <div class="col-xs-12 text-center table-page-container">
                    <a class="table-page-first" href="?page=1"> < </a>
                        {% for page_num in requested_intpr.start_page|get_range_from_to2:requested_intpr.end_page %}
                            {% if page_num == requested_intpr.now_page %}
                                <b>
                            {% endif %}
                        <a class="table-page-number" href="?page={{ page_num }}">{{ page_num }}</a>
                            {% if page_num == requested_intpr.now_page %}
                                </b>
                            {% endif %}
                        {% endfor %}
                    <a class="table-page-last" href="?page={{ interpret.end_page }}"> > </a>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

{% include 'miaas/template_footer.html' %}

<!-- custom javascript -->
<script type="text/javascript">
$('#selectSearch').change(function() {
    if($(this).val() == 'Request Subject') {
        $('#inputSearch').show();
        $('#selectImageType').hide();
    } else if ($(this).val() == 'Image Type') {
        $('#inputSearch').hide();
        $('#selectImageType').show();
    }
});
</script>

</body>
</html>
